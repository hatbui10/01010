<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Radar t·∫ßn s·ªë th·∫•p</title>

<style>
body {
    margin: 30px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    
    font-family: Arial, sans-serif;
}

h2 {
    color: #fff;
    margin-bottom: 15px;
    text-align: center;
}
    h1 {
    color:  #8E24AA;
    margin: 5px;
    text-align: center;
}

.wheel-wrapper {
    position: relative;
    width: 320px;
    height: 320px;
}

canvas {
    border-radius: 50%;
    background: #fff;
    box-shadow: inset 0 0 8px rgba(0,0,0,0.15);
}

/* M≈®I T√äN CH·ªà XU·ªêNG */
.pointer {
    position: absolute;
    top: -6px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 12px solid transparent;
    border-right: 12px solid transparent;
    border-top: 22px solid #000;
    filter: drop-shadow(0 2px 2px rgba(0,0,0,0.4));
}

button {
    margin-top: 20px;
    padding: 10px 28px;
    font-size: 16px;
    border-radius: 20px;
    border: none;
    background: 2845D6;
    color: #fff;
    cursor: pointer;
}

button:active {
    transform: scale(0.97);
}

#result {
    margin: 15px;
    color: yellow;
    font-size: 50px;
    font-weight: bold;
}

.wheel-frame::before {
    content: "";
    position: absolute;
    inset: -6px;
    border-radius: 50%;
    background: conic-gradient(
        from 0deg,
        #ff9800,
        #ffc107,
        #ff9800
    );
    filter: blur(8px);
    opacity: 0.6;
    z-index: -1;
}
.wheel-frame {
    position: relative;
}

.app-box {
    padding: 28px 26px 32px;
    border-radius: 28px;
    background: red;
    box-shadow:
        0 18px 40px rgba(0,0,0,0.35),
        inset 0 4px 10px rgba(255,255,255,0.8);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
}


</style>
</head>

<body>

<div class="app-box">
    <h2>Nghi√™m t√∫c gi·ªØ k·ª∑ lu·∫≠t th√¨ s·∫Ω ti·∫øn b·ªô</h2>
    <h1>T·ªëc ƒë·ªô h·ªìi ph·ª•c : 1-3-9-27-81-160</h1>
    <h1 id="spinCountText">S·ªë l∆∞·ª£t quay h√¥m nay: 0 / 15</h1>
     <h1>Th·ªùi gian b·∫Øt ƒë·∫ßu sau 2 gi·ªù  </h1>
    
<div id="result"></div>
    <div class="wheel-frame">
        <div class="wheel-wrapper">
            <div class="pointer"></div>
            <canvas id="wheel" width="320" height="320"></canvas>
        </div>
    </div>

    <button onclick="spin()">Spin</button>
    
</div>
<button onclick="resetSpin()">Reset (test)</button>


<script>
const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");
const radius = canvas.width / 2;

const items = [
    
    "0",
     "1-1",
    "1-0-1-0-0",
    "1-1-0",
    "0-1-1-0",
    "1",
     "1-1-0-1",
     "1-0",
       "1-0-0-1",
     "0-1-0",
    "0-0-1-0",
     "1-0-0-1-0"
];


  const colors = [
  "#FF3B30", // ƒë·ªè cam ‚Äì ƒë·∫≠p v√†o m·∫Øt
  "#FF9500", // cam t∆∞∆°i ‚Äì n·ªïi b·∫≠t
  "#FFCC00", // v√†ng ƒë·∫≠m ‚Äì s√°ng r√µ
  "#34C759", // xanh l√° t∆∞∆°i ‚Äì c√¢n b·∫±ng m·∫Øt
  "#00C7BE", // xanh ng·ªçc ‚Äì m√°t nh∆∞ng kh√¥ng ch√¨m
  "#007AFF", // xanh d∆∞∆°ng ‚Äì r√µ r√†ng
  "#5856D6", // t√≠m xanh ‚Äì t·∫°o chi·ªÅu s√¢u
  "#AF52DE", // t√≠m h·ªìng ‚Äì n·ªïi m√† kh√¥ng s·∫øn
  "#FF2D55", // h·ªìng ƒë·∫≠m ‚Äì r·∫•t b·∫Øt m·∫Øt
  "#8E8E93", // x√°m ƒë·∫≠m ‚Äì ngh·ªâ m·∫Øt gi·ªØa c√°c m√†u g·∫Øt
  "#F2E3BB" , // g·∫ßn ƒëen ‚Äì t·∫°o t∆∞∆°ng ph·∫£n m·∫°nh
      "#34C759"// xanh l√° t∆∞∆°i ‚Äì c√¢n b·∫±ng m·∫Øt
];


const MAX_SPINS = 9;
const COOLDOWN_HOURS = 2;
const STORAGE_KEY = "wheel_spin_data";

function getSpinData() {
    const data = localStorage.getItem(STORAGE_KEY);
    return data ? JSON.parse(data) : { count: 0, lockedUntil: 0 };
}

function saveSpinData(data) {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
}

function updateSpinText() {
    const data = getSpinData();
    document.getElementById("spinCountText").innerText =
        `S·ªë l∆∞·ª£t quay h√¥m nay: ${data.count} / ${MAX_SPINS}`;
}

let angle = 0;
let spinning = false;

function drawWheel() {
    const arc = 2 * Math.PI / items.length;
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    for (let i = 0; i < items.length; i++) {
        const start = angle + i * arc;

        ctx.beginPath();
        ctx.moveTo(radius, radius);
        ctx.arc(radius, radius, radius, start, start + arc);
        ctx.fillStyle = colors[i];
        ctx.fill();

        ctx.save();
        ctx.translate(radius, radius);
        ctx.rotate(start + arc / 2);
        ctx.textAlign = "right";
        ctx.fillStyle = "#000";
        ctx.font = "bold 18px Arial";

        ctx.fillText(items[i], radius - 25, 5);
        ctx.restore();
    }
}

function spin() {
    if (spinning) return;

    const data = getSpinData();
    const now = Date.now();

    // ƒëang trong th·ªùi gian ch·ªù
    if (now < data.lockedUntil) {
        const minutesLeft = Math.ceil((data.lockedUntil - now) / 60000);
        alert(`H√¥m nay ƒë·ªß r·ªìi üòå\nH√£y ƒë·ª£i ${minutesLeft} ph√∫t n·ªØa ƒë·ªÉ ti·∫øp t·ª•c`);
        return;
    }

    // reset sau khi h·∫øt cooldown
    if (data.count >= MAX_SPINS) {
        data.count = 0;
        data.lockedUntil = 0;
        saveSpinData(data);
    }

    spinning = true;

    const duration = 3000;
    const start = performance.now();
    const startAngle = angle;
    const extraRounds = 5;
    const randomOffset = Math.random() * 2 * Math.PI;

    function animate(now) {
        const elapsed = now - start;
        const progress = Math.min(elapsed / duration, 1);
        const easeOut = 1 - Math.pow(1 - progress, 3);

        angle =
            startAngle +
            easeOut * (extraRounds * 2 * Math.PI + randomOffset);

        drawWheel();

        if (progress < 1) {
            requestAnimationFrame(animate);
        } else {
            spinning = false;

            // tƒÉng s·ªë l∆∞·ª£t
            data.count++;

            // ƒë·ªß 9 l∆∞·ª£t th√¨ kh√≥a 2 gi·ªù
            if (data.count >= MAX_SPINS) {
                data.lockedUntil = Date.now() + COOLDOWN_HOURS * 60 * 60 * 1000;
                alert("H√¥m nay ƒë·ªß r·ªìi üò¥\nH√£y ƒë·ª£i 2 gi·ªù n·ªØa ƒë·ªÉ ti·∫øp t·ª•c");
            }

            saveSpinData(data);
            updateSpinText();
            showResult();
        }
    }

    requestAnimationFrame(animate);
}

    function resetSpin() {
    localStorage.removeItem("wheel_spin_data");
    updateSpinText();
    alert("ƒê√£ reset s·ªë l∆∞·ª£t quay");
}

function showResult() {
    const arc = 2 * Math.PI / items.length;

    // m≈©i t√™n ·ªü tr√™n, ch·ªâ xu·ªëng
    const normalizedAngle =
        (angle + Math.PI / 2) % (2 * Math.PI);

    const index =
        Math.floor((2 * Math.PI - normalizedAngle) / arc) % items.length;

    document.getElementById("result").innerText =
        "K·∫øt qu·∫£: " + items[index];
}

drawWheel();
updateSpinText();

</script>

</body>
</html>



